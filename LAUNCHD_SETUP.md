# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ glping —Å launchd (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è macOS)

## –ü–æ—á–µ–º—É launchd –ª—É—á—à–µ crontab?

- ‚úÖ **–ù–∞—Ç–∏–≤–Ω—ã–π –¥–ª—è macOS** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏
- ‚úÖ **–ò–¥–µ–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ GUI –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –ø—Ä–∏ —Å–±–æ—è—Ö —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
- ‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - stdout –∏ stderr –≤ —Ñ–∞–π–ª—ã
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º** - –∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

## –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
./launchd_setup.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–∫–æ–ø–∏—Ä—É–µ—Ç plist —Ñ–∞–π–ª –≤ `~/Library/LaunchAgents/`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –ó–∞–≥—Ä—É–∑–∏—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
launchctl list | grep glping

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
tail -f logs/glping.log
```

## –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

### 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ plist —Ñ–∞–π–ª:
```bash
cp com.glping.daemon.plist ~/Library/LaunchAgents/
```

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
launchctl load ~/Library/LaunchAgents/com.glping.daemon.plist
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
launchctl start com.glping.daemon
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

### –ó–∞–ø—É—Å–∫/–û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å
launchctl start com.glping.daemon

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
launchctl stop com.glping.daemon

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
launchctl kickstart -k gui/$(id -u)/com.glping.daemon
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥
tail -f logs/glping.log

# –û—à–∏–±–∫–∏
tail -f logs/glping.error.log

# –û–±–∞ —Å—Ä–∞–∑—É
tail -f logs/glping.log logs/glping.error.log
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞:
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏
./launchd_cleanup.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
launchctl stop com.glping.daemon
launchctl unload ~/Library/LaunchAgents/com.glping.daemon.plist
rm ~/Library/LaunchAgents/com.glping.daemon.plist
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:
–û—Ç–∫—Ä–æ–π—Ç–µ `com.glping.daemon.plist` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
```xml
<key>StartInterval</key>
<integer>300</integer> <!-- —Å–µ–∫—É–Ω–¥ (300 = 5 –º–∏–Ω—É—Ç) -->
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ Python:
–ï—Å–ª–∏ Python –≤ –¥—Ä—É–≥–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```xml
<key>ProgramArguments</key>
<array>
    <string>/path/to/your/python3</string>
    <string>/Users/vladimirnosov/Downloads/glping/glping/main.py</string>
</array>
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞–¥ crontab

| –ü–∞—Ä–∞–º–µ—Ç—Ä | launchd | crontab |
|----------|---------|---------|
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | ‚úÖ –ò–¥–µ–∞–ª—å–Ω—ã–µ | ‚ùå "–û—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤" |
| –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ | ‚úÖ | ‚úÖ |
| –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π | ‚ùå –†—É—á–Ω–æ–π |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ | ‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ | ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ |
| macOS –Ω–∞—Ç–∏–≤–Ω–æ—Å—Ç—å | ‚úÖ | ‚ùå Unix —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–π |

## Troubleshooting

### –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å plist
plutil -lint ~/Library/LaunchAgents/com.glping.daemon.plist

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏
cat logs/glping.error.log
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ terminal-notifier —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
which terminal-notifier

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
grep -i "notification" logs/glping.log
```

### –°–µ—Ä–≤–∏—Å –Ω–µ –≤–∏–¥–µ–Ω:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ plist –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -la ~/Library/LaunchAgents/com.glping.daemon.plist

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–≥—Ä—É–∂–µ–Ω
launchctl list | grep glping
```

## –ü–µ—Ä–µ—Ö–æ–¥ —Å crontab

1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–µ–∫—É—â—É—é crontab:**
   ```bash
   crontab -l > crontab_backup.txt
   ```

2. **–£–¥–∞–ª–∏—Ç–µ glping –∏–∑ crontab:**
   ```bash
   crontab -e
   # –£–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å glping
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ launchd:**
   ```bash
   ./launchd_setup.sh
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:**
   ```bash
   tail -f logs/glping.log
   ```

–¢–µ–ø–µ—Ä—å glping –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–¥–µ–∞–ª—å–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ macOS! üéâ